\documentclass[11pt,letterpaper,onecolumn]{scrartcl}
\usepackage{tocloft}
\usepackage{stdclsdv}
\usepackage{comment}
\usepackage{vmargin}
\usepackage{t1enc}
\usepackage{fancyvrb}
\usepackage{url}
\usepackage{calc}
\usepackage{array}
\usepackage{graphicx}
\usepackage{color}
\usepackage{listings}
\usepackage[latin1]{inputenc}
\usepackage[english]{babel}
\usepackage{supertabular}
\usepackage{fancyhdr}
\usepackage{multicol}
\usepackage{float}
\usepackage{textcomp}
\usepackage{alltt}
\definecolor{LstColor}{cmyk}{0.1,0.1,0,0.025} 
\setcounter{tocdepth}{1}
\ifx\pdfoutput\undefined
\usepackage[ps2pdf,
            pagebackref=true,
            colorlinks=true,
            linkcolor=blue
           ]{hyperref}
\usepackage{pspicture}
\else
\usepackage[pdftex,
            pagebackref=true,
            colorlinks=true,
            linkcolor=blue,
            pdfpagelabels,
            pdfstartpage=2
           ]{hyperref}
\fi
\renewcommand{\headheight}{14pt}

\begin{document}
\begin{sloppypar}

\lstset{language=c++,basicstyle=\ttfamily\tiny,commentstyle=\ttfamily\tiny,tabsize=2,breaklines,backgroundcolor=\color{LstColor},fontadjust=true,keepspaces=false,fancyvrb=true,showstringspaces=false,moredelim=[is][\textbf]{\\emph\{}{\}}}.
\title{Csound Windows Build \\ 5.12.1}

\author{Michael Gogins \\ \texttt{michael.gogins@pipemailline.com}}
\maketitle

\section{Introduction}
\label{sec:Introduction}

This file should be updated in reasonable detail with each release of the Windows installers for Csound, in order to provide instructions for building Csound on Windows. Please note the last date each package was updated and, if relevant, its current version number. Do this, of course, \emph{only} if your build succeeds \emph{and} the package version is more recent than the one previously recorded in this document.

Hyperlinks to repositories are provided to speed downloading and installing third-party dependencies.

Csound on Windows is built using MinGW/MSys from (\url{www.mingw.org}). Code is built for release, with full optimizations including intrinsics and vectorization. These optimizations may preclude debugging. In that case, a separate debug build must be made in order to debug. However, the only differences between the debug build and the release build must be the presence or absence of optimizations and the generation or not of debugging information. Code generation for both builds must be for ``release versions'' of the runtime libraries and third party libraries. This code generation standard also applies, of course, to actually building the third party libraries.

All third party libraries will be updated from the most recent version that seems to be used by a majority of their users --- whatever that is (trunk, most recent tag, stable release, whatever). If pre-built binaries are available, use them. Otherwise, build third party libraries with the same version of the compiler that is used to build Csound itself. If the library does not come with a functional build system for MinGW/MSys, create an SConstruct file for it. However, some libraries have to be built with Microsoft Visual C++, of which fortunately there is a free Express Edition.

The conceit of this build system is that Csound is built in a standard Linux environment, which is simulated using MSys, using the standard GNU compiler, which is MinGW. To assist us in this delusion, the Linux root directory is simulated by \url{C:/utah}, which contains a more or less standard Linux filesystem (at least, it does when in the MSys shell). Third party libraries are therefore located in \url{/c/utah/opt}.

\section{Build Steps}
\label{sec:BuildSteps}

\begin{enumerate}
	\item (Done) Update the documentation tools.
		\begin{enumerate}
	    \item (Done) Update the docbook toolchain:
				\begin{enumerate}
					\item (Done) Install the current Windows build of \texttt{xsltproc} from \url{http://www.zlatkovic.com/libxml.en.html}. This may involve also installing libraries upon which \texttt{xsltproc} depends.
					\item (Done) Install the current Docbook XML DTDs from \url{http://www.oasis-open.org/docbook/xml/4.5/docbook-xml-4.5.zip}.
					\item (Done) Install the current Docbook XSL stylesheets from \url{http://sourceforge.net/project/downloading.php?group_id=21935&filename=docbook-xsl-1.75.1.zip}Fill in the \texttt{rewritePrefix} attributes to make the \url{catalog.xml} file be something like:
					\begin{lstlisting}
<?xml version="1.0" encoding="utf-8"?>
<catalog xmlns="urn:oasis:names:tc:entity:xmlns:xml:catalog">
  <!-- XML Catalog file for DocBook XSL Stylesheets v1.75.1 -->
  <rewriteURI uriStartString="http://docbook.sourceforge.net/release/xsl/current/" rewritePrefix="file:///C:/utah/opt/docbook-xsl-1.75.1/"/>
  <rewriteSystem systemIdStartString="http://docbook.sourceforge.net/release/xsl/current/" rewritePrefix="file:///C:/utah/opt/docbook-xsl-1.75.1/"/>
  <rewriteURI uriStartString="http://docbook.sourceforge.net/release/xsl/1.75.1/" rewritePrefix="file:///C:/utah/opt/docbook-xsl-1.75.1/"/>
  <rewriteSystem systemIdStartString="http://docbook.sourceforge.net/release/xsl/1.75.1/" rewritePrefix="file:///C:/utah/opt/docbook-xsl-1.75.1/"/>
  <rewriteURI uriStartString="http://www.oasis-open.org/docbook/xml/4.2/" rewritePrefix="file:///C:/utah/opt/docbook-xml-4.5/"/>
  <rewriteSystem systemIdStartString="http://www.oasis-open.org/docbook/xml/4.2/" rewritePrefix="file:///C:/utah/opt/docbook-xml-4.5/"/>
</catalog>
					\end{lstlisting}
				\end{enumerate}

	    \item (Done) Update LaTeX to MikTex version 2.8 from \url{http://miktex.org}.
	    \item (Done) Update TeXniCenter to version 1 Stable RC1 from \url{http://www.texniccenter.org}. 
	    \item (Done) Update Doxygen to the current version (1.7.1) from \url{http://www.stack.nl/~dimitri/doxygen}.
	    \item (Done) Update ATT Graphviz to version 2.26.3 from \url{http://www.graphviz.org}.
		\end{enumerate}
	\item (Done) Update the build tools.   
		\begin{enumerate}
  		\item (Done) Update Python.
				\begin{enumerate}
					\item (Done) Install the most recent ``standard'' version (currently 2.6.5) \emph{that works with all the other stuff we need for Csound} (see other Python packages below) from \url{www.python.org}.
	    		\item (Done) Update SCons from \url{www.scons.org} to the most recent ``standard'' version (currenty 2.0.0).
	    	  \item (Done) Update the Psyco just in time compiler with Subversion using \verb|svn co http://codespeak.net/svn/psyco/dist/ psyco-dist|  to the most recent version (currently 1.6) and install from sources in the MSys shell using \verb|python setup.py install compiler=mingw32|.
	    		\item (Done) Update NumPy (currently version 1.4.1) and SciPy (currently version 0.8.0) from \url{http://www.scipy.org}.
	    		\item (Done) Update VPython from \url{http://vpython.org/index.html} to the most recent version (currently Visual 5).
	    		\item (Done) Update wxPython from \url{http://www.wxpython.org} to the most recent version (currently 2.8.10.1).
				\end{enumerate}
			\item (Done) Getting an up to date GNU Compiler Collection software development toolchain going for Windows is entirely possible and results in a compiler that is completely competitive with Microsoft's best, but installation can be a scattered and difficult process. It is to be hoped that the first alternative below will work for you. 
				\begin{enumerate}
					\item Either:
						\begin{enumerate}
							\item (Done) Update MSYS and MinGW using the instructions at: \url{http://www.cccp-project.net/wiki/index.php?title=Installing_MSYS-MinGW}, using the most recent installation script at the bottom of the page. This should install a more or less up to date version of MSYS, and a somewhat less up to date version of MinGW.
						\end{enumerate}
					\item Or:
						\begin{enumerate}
							\item (Not applicable) Update MSys base (current version 1.0.11-rc-1) and MSys supplementary tools from \url{http://sourceforge.net/projects/mingw}. 
							\item (Not applicable -- no longer available) Update MSYS with pkg.m4 from \url{http://johnnypops.demon.co.uk/mingw/msys-pkg-config-win32.zip}. 
			  		\end{enumerate}
					\end{enumerate}
				\item (Done) Install (actually if you used in the install script from the first option, you will be \emph{re}-installing) the latest version of the Twilight Dragon Media build of MinGW from \url{http://www.tdragon.net} (currently 4.5.0). The sjlj version of the compiler must be used instead of the dw2 version, even though the dw2 compiler builds somewhat faster code, because the dw2 compiler generates buggy code for DLL relocations.
				\item (Done) For \texttt{pkg-config} and some other things, update the GTK+ development package for MinGW using the all-in-one bundle at \url{http://ftp.gnome.org/pub/gnome/binaries/win32/gtk+/2.20/gtk+-bundle_2.20.0-20100406_win32.zip}.
				\item (Done) Install Visual C++ 2010 Express Edition from Microsoft at \url{http://www.microsoft.com/express/Downloads/#2010-Visual-CPP}.		
		
	    \item (Done) Update SWIG from \url{www.swig.org} to the most recent ``standard'' version (currently 2.0.0).
	    \item (Done) Update the Java Development Kit from \url{http://java.sun.com/javase/downloads/index.jsp} to the most recent ``standard'' version (currently Java SE 6 Update 21).
	    \item (Done) Update the CMake cross-platform build configurator and makefile generator (current version 2.80) from \url{http://www.cmake.org/cmake/resources/software.html}.
		\end{enumerate}    
	\item (Done) Update third-party libraries.   
		\begin{enumerate}
    	\item (Done) Install the VST SDK 2.4 from \url{http://www.steinberg.net/en/company/3rd_party_developer.html}.
    	\item (Done) Install Pure Data sources using Subversion from \url{https://pure-data.svn.sourceforge.net/svnroot/pure-data}.4
    	\item (Done) Instsll Tcl (current version 8.5.8.2) from \url{http://www.activestate.com/activetcl/downloads}.
   		\item (Done) Update boost from \url{www.boost.org} to the most recent stable version (currently 1.43.0).
  		\item (Done) Update Gmm++ from \url{http://home.gna.org/getfem/download.html} to the most recent stable version (currently 4.1), and build it by running the \texttt{configure} script and \texttt{make}.
    	\item (Done) Update the Synthesis Toolkit in C++ (STK) and build with \texttt{configure}.
				\begin{enumerate}
					\item (Done) Update from \url{http://ccrma.stanford.edu/software/stk} to the most recent version (currently 4.4.2). 
					\item (Done) Copy all contents of the STK directory into the Csound \texttt{Opcodes/stk} directory.
					\item (Done -- I didn't see any.) Apply any patches from the web site and mailing list. 
				\end{enumerate}   	
			\item (Done) Update libsndfile from \url{http://www.mega-nerd.com/libsndfile} to the most recent version that works, which may be pre-release or release; currently it is 1.0.21. Do not build from sources. 
    	\item (Done) Update FLTK from \url{www.fltk.org} to \texttt{branch-1.3 HEAD} from SVN and build it with MinGW using Cmake, with threads enabled, shared libraries enabled, and local FLTK builds of the \texttt{jpeg}, \texttt{png}, and \texttt{	} libraries. 
     	\item (Done) Update liblo tag 0.26 from the tarball at \url{http://liblo.sourceforge.net} (\emph{not} SVN!), and build with this SConstruct:
    	
\begin{lstlisting}
# S C O N S T R U C T   F O R   L I B L O . D L L
# Michael Gogins
# Using hints from: http://clam.iua.upf.edu/wikis/clam/index.php/Devel/Windows_MinGW_cross_compile#liblo

environment = Environment(tools = ['mingw'])

sources = '''
src/address.c
src/blob.c
src/bundle.c
src/message.c
src/method.c
src/pattern_match.c
src/send.c
src/server.c
src/server_thread.c
src/timetag.c
'''

cppath = '''
.
C:/utah/opt/liblo
C:/utah/opt/liblo/lo
C:/utah/opt/pthreads/Pre-built.2/include
'''

libpath = '''
C:/utah/mingw/lib
C:/utah/opt/pthreads/Pre-built.2/lib
'''

environment.Append(CFLAGS = Split('-O2 -g -DHAVE_CONFIG_H -D_WIN32_WINNT=0x0501'))
environment.Append(CPPPATH = Split(cppath))
environment.Append(LIBPATH = Split(libpath))
environment.Append(LIBS = Split('pthread kernel32 gdi32 wsock32 ws2_32 ole32 uuid winmm pthread kernel32 gdi32 wsock32 ws2_32 ole32 uuid winmm'))
environment.Append(LINKFLAGS = ['-Wl,--enable-stdcall-fixup', '-Wl,-export-dynamic'])

liblo = environment.SharedLibrary('lo', Split(sources))
\end{lstlisting}

 			\item (Done) Update FluidSynth from \url{http://sourceforge.net/apps/trac/fluidsynth} to the head version (currently 1.1.1). Run \texttt{cmake-gui} for Visual C++ to configure and generate a Visual C++ solution, then load the solution in Visual C++ and build the release version.
   		\item (Done) Update the pthread library from \url{http://sources.redhat.com/pthreads-win32} to the most recent stable version (currently 2.8.0). Build in \url{pthread2.2} using \verb|make -f GNUmakefile clean GC|. Copy the DLL and lib into the pre-built directory. Copy those files and rename them \texttt{pthread.dll} and \texttt{libpthread.a}.
   		\item (Done) Update the Microsoft DirectX SDK (current version June 2010) by simply installing it from \url{http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=3021d52b-514e-41d3-ad02-438a3ba730ba}.
			\item (Done) Update the PortAudio library (\url{http://portmedia.sourceforge.net}) from SVN and build it. Try the trunk version first, if that doesn't work use the most recent tag. At this time, I can't figure out how to build the kernel streaming driver, so omit it. 
			Check the \verb|pa_win_hostapis.c| file and make sure that it is configured like this to build the DirectSound, WMME, and ASIO drivers:
			
\begin{lstlisting}
#define PA_NO_WDMKS
PaUtilHostApiInitializer *paHostApiInitializers[] =
    {
#ifndef PA_NO_WMME
        PaWinMme_Initialize,
#endif
#ifndef PA_NO_DS
        PaWinDs_Initialize,
#endif
#ifndef PA_NO_ASIO
        PaAsio_Initialize,
#endif
#ifndef PA_NO_WASAPI
		PaWinWasapi_Initialize,
#endif
#ifndef PA_NO_WDMKS
       PaWinWdm_Initialize,
#endif
        PaSkeleton_Initialize, /* just for testing */
        0   /* NULL terminated array */
    };
\end{lstlisting}

Comment out the declaration/definition of \texttt{InterlockedDecrement} in the ASIO SDK sources.
			
Build with this SConstruct, which contains many kludgey ways of dealing with almost incompatible header files, versions of DirectX SDKs, etc.\ (you have been warned):
			
\begin{lstlisting}
'''
MinGW SConstruct for PortAudio
Michael Gogins
'''
print __doc__
print

import os
import string
import sys
import traceback

commonEnvironment = Environment(ENV = os.environ, tools = ['mingw', 'swig', 'javac', 'jar'])
commonEnvironment.Append(CFLAGS = Split('-O2 -g '))
commonEnvironment.Append(CPPFLAGS = Split('''
-DWIN32 
-D_WIN32 
-DWINDOWS 
-DKSAUDIO_SPEAKER_DIRECTOUT=0 
-DMETHOD_NEITHER=3
-DFILE_ANY_ACCESS=0
-DTIME_KILL_SYNCHRONOUS=0x0100
'''))

commonEnvironment.Append(CPPPATH = Split('''
. 
C:/utah/opt/Qt/2010.04/mingw/include
src/common 
src/hostapi 
src/os 
src/os/win 
include 
C:/utah/opt/portaudio/src/hostapi/asio/ASIOSDK/host
C:/utah/opt/portaudio/src/hostapi/asio/ASIOSDK/host/pc
C:/utah/opt/portaudio/src/hostapi/asio/ASIOSDK/common
src/hostapi/wasapi/mingw-include
C:/utah/opt/stk-4.4.2/src/include
C:/utah/opt/directx-sdk-2010-06/Include
'''))

commonEnvironment.Append(LIBS=Split('''
setupapi
kernel32
user32
gdi32
winspool
comdlg32
advapi32
shell32
ole32
oleaut32
uuid
odbc32
odbccp32
winmm
strmiids 
'''))

portAudioSources = Split('''
src/common/pa_allocation.c
src/common/pa_converters.c
src/common/pa_cpuload.c
src/common/pa_debugprint.c
src/common/pa_dither.c
src/common/pa_front.c
src/common/pa_process.c
src/common/pa_ringbuffer.c
src/common/pa_skeleton.c
src/common/pa_stream.c
src/common/pa_trace.c
src/hostapi/dsound/pa_win_ds.c
src/hostapi/dsound/pa_win_ds_dynlink.c
src/hostapi/wmme/pa_win_wmme.c
src/os/win/pa_win_hostapis.c
src/os/win/pa_win_util.c
src/os/win/pa_win_waveformat.c
src/hostapi/asio/ASIOSDK/common/asio.cpp
src/hostapi/asio/ASIOSDK/common/combase.cpp
src/hostapi/asio/ASIOSDK/common/debugmessage.cpp
src/hostapi/asio/ASIOSDK/common/register.cpp
src/hostapi/asio/ASIOSDK/host/ASIOConvertSamples.cpp
src/hostapi/asio/ASIOSDK/host/asiodrivers.cpp
src/hostapi/asio/ASIOSDK/host/pc/asiolist.cpp
src/hostapi/asio/iasiothiscallresolver.cpp
src/hostapi/asio/pa_asio.cpp
src/hostapi/wasapi/pa_win_wasapi.c
''')

portAudio = commonEnvironment.SharedLibrary('portaudio', portAudioSources)
\end{lstlisting}

			\item (Done) Update the PortMidi library (\url{http://portmedia.sourceforge.net}) from SVN and build it with this SConstruct:
			
\begin{lstlisting}
'''
MinGW SConstruct for PortMidi
Michael Gogins
'''
print __doc__
print

import os
import string
import sys
import traceback

commonEnvironment = Environment(ENV = os.environ, tools = ['mingw', 'swig', 'javac', 'jar'])
commonEnvironment.Append(CFLAGS = Split('-O2 -g '))
commonEnvironment.Append(CPPFLAGS = Split('''
-DWIN32 
-D_WIN32 
-DWINDOWS 
'''))
commonEnvironment.Append(CPPPATH = Split('''
. 
pm_win
pm_common
porttime
'''))
commonEnvironment.Append(LIBS=Split('''
setupapi
kernel32
user32
gdi32
winspool
comdlg32
advapi32
shell32
ole32
oleaut32
uuid
odbc32
odbccp32
winmm
strmiids 
'''))
commonEnvironment.Append(LIBPATH='.')
commonEnvironment.Append(SHLINKFLAGS = Split('-mwindows -mno-cygwin -Wl,--enable-auto-import -Wl,--enable-runtime-pseudo-reloc'))

portMidiSources = Split('''
pm_common/pmutil.c
pm_common/portmidi.c
pm_win/pmwin.c
pm_win/pmwinmm.c
''')

portTimeSources = Split('''
porttime/porttime.c
porttime/ptwinmm.c
''')

portMidiTestSources = Split('''
pm_test/test.c
''')

porttime = commonEnvironment.SharedLibrary('porttime', portTimeSources)

portMidiEnvironment = commonEnvironment.Copy()
portMidiEnvironment.Append(LIBS='porttime')
portmidi = portMidiEnvironment.SharedLibrary('portmidi', portMidiSources)

portMidiTestEnvironment = commonEnvironment.Copy()
portMidiTestEnvironment.Append(LIBS=Split('portmidi porttime'))
test = portMidiTestEnvironment.Program('test', portMidiTestSources)

Depends(portmidi, porttime)
Depends(test, portmidi)
\end{lstlisting}

			Run the test program to ensure that the build works.
		  
		  \item (Done) Update LuaJIT from \url{http://luajit.org} to the head version (currently 2.0.0 beta 4) and build it using the command:
		  
\begin{lstlisting}
make clean; make; make install
\end{lstlisting}

			\item (Done) Update the MusicXML library.
			  \begin{enumerate}
			    \item (Done) Update using Subversion from \url{https://libmusicxml.svn.sourceforge.net/svnroot/libmusicxml}.
			    \item (Done) Edit the CodeBlocks project so as not to build and not to link \verb|xmllex.c++|, which is \verb|#included| by \verb|xmlparse.cpp|.
			    \item (Done) Build the library (only) for release using the CodeBlocks project.
			  \end{enumerate}

			\item (Done) Install the LGPL/Free license version of the Qt 4.5 software development kit for Windows from \url{http://www.qtsoftware.com/downloads}.
	\item (Not done) Build   
		\begin{enumerate}				
			\item (Not done) Double precision sample build -- the only target at this time.
				\begin{enumerate}
		    	\item (Not done) Update \texttt{custom-mingw.py} and \texttt{custom-msvc.py} to reflect the locations of third-party header files and libraries.
					\item (Not done) Update Csound from CVS at \verb|csound.cvs.sourceforge.net:/cvsroot/csound|, module \texttt{csound5}..
					\item (Not done) Update \emph{The Canonical Csound Reference Manual} from CVS at \verb|csound.cvs.sourceforge.net:/cvsroot/csound|, module \texttt{manual}. Build the \texttt{html-dist} target.
					\item (Not done) Run \texttt{./cleanup.sh} to make everything really clean.
			    \item (Not done) Build Csound using \texttt{build-mingw-release-double.sh}. You will have to make some additional patches to the STK sources for the updated MinGW compiler. The patches should be obvious from context. Mostly you need to \verb|#include <some_std_header>|.
			    \item (Not done) Build again as above, to ensure \texttt{csnd.jar} is built properly.
			    \item (Not done) Change to \texttt{examples/java} and execute \texttt{make} to build example jars.
			
			\item (Not done) Use Subversion to install the current QuteCsound source code from \url{https://qutecsound.svn.sourceforge.net/svnroot/qutecsound/trunk/qutecsound}. Make a second copy of the source tree for the float sample build of QuteCsound.
			
			Rebuild QuteCsound using the following commands, possibly with INCLUDEPATH and LIBPATH modified for your system:
			
			\begin{lstlisting}
qmake -makefile -win32 "CONFIG+=build64" DEFAULT_CSOUND_INCLUDE_DIRS=D:\utah\home\mkg\csound-mingw-release\H INCLUDEPATH+=D:\utah\home\mkg\csound-mingw-release\interfaces DEFAULT_LIBSNDFILE_INCLUDE_DIRS=D:\utah\opt\Mega-Nerd\libsndfile\include INCLUDEPATH+=C:\utah\opt\Qt\2009.03\qt\include\QtXml INCLUDEPATH+=c:\utah\opt\qutecsound\src  DEFAULT_CSOUND_LIBRARY_DIRS=D:\utah\home\mkg\csound-mingw-release DEFAULT_LIBSNDFILE_LIBRARY_DIRS=D:\utah\opt\Mega-Nerd\libsndfile qcs.pro
mingw32-make release
			\end{lstlisting}
			
			\noindent Or, for float samples, something like:
			
			\begin{lstlisting}
qmake "CONFIG+=build32" INCLUDEPATH+=D:\utah\home\mkg\csoundf\H INCLUDEPATH+=D:\utah\home\mkg\csoundf\interfaces INCLUDEPATH+=D:\utah\opt\Mega-Nerd\libsndfile\include INCLUDEPATH+=C:\utah\opt\Qt\2009.03\qt\include\QtXml LIBPATH+=D:\utah\home\mkg\csoundf LIBPATH+=D:\utah\opt\Mega-Nerd\libsndfile qcs.pro
mingw32-make release
			\end{lstlisting}
			
			\noindent This make will fail, because the QuteCsound \texttt{.pro} files were not written in a portable style. Copy the link line, omit the hard-coded libraries for \texttt{csnd}, \texttt{libcsound64}, and \texttt{libsndfile}, change to the \texttt{src} directory, add the required libraries and library paths, and re-run the edited link line, something like this:
			
			\begin{lstlisting}
g++ -enable-stdcall-fixup -Wl,-enable-auto-import -Wl,-enable-runtime-pseudo-reloc -mthreads -Wl -Wl,-subsystem,windows -o bin\qutecsound.exe object_script.qutecsound.Release -L"d:\utah\home\mkg\csound-mingw-release" -L"d:\utah\opt\Mega-Nerd\libsndfile" -L"c:\utah\opt\Qt\2009.03\qt\lib" -lmingw32 -lqtmaind debug\qutecsound_res.o -lcsnd -lcsound64 -lsndfile-1 -lQtXml4 -lQtGui4 -lQtCore4
strip bin/*	
			\end{lstlisting}
			
			\noindent Or, for float samples, something like:
			
			\begin{lstlisting}
g++ -enable-stdcall-fixup -Wl,-enable-auto-import -Wl,-enable-runtime-pseudo-reloc -mthreads -Wl -Wl,-subsystem,windows -o release\qutecsoundf.exe object_script.qutecsoundf.Release  -L"d:\utah\home\mkg\csoundf" -L"d:\utah\opt\Mega-Nerd\libsndfile" -L"d:\utah\home\mkg\csoundf" -L"d:\utah\opt\Mega-Nerd\libsndfile" -L"c:\utah\opt\Qt\2009.03\qt\lib" -lmingw32 -lqtmain -lcsnd -lcsound32 -lsndfile-1 -lQtXml4 -lQtGui4 -lQtCore4
strip bin/*	
			\end{lstlisting}	
			
 		\end{enumerate}
			    \item (Not done) Build the manual using a command line such as \verb|make html-dist XSL_BASE_PATH=C:/utah/opt/docbook-xsl-1.75.1|
			    \item (Not done) Build the API reference by executing \texttt{doxygen}.
			    \item (Not done) Execute \texttt{strip.sh} to strip debugging information out of the binaries.
			    \item (Not done) Build the installer using NSIS from \url{http://nsis.sourceforge.net/Main_Page} \emph{with} the \verb|NONFREE| (VST) stuff.  
			    \item (Not done) Uninstall Csound, and install it again using the installer. Use the Microsoft Dependency Walker and profile \texttt{QuteCsound} running to verify that all DLLs required have been installed, or are already part of Windows.
			    \item (Not done) Build the installer \emph{without} the \verb|NONFREE| stuff.   
				\end{enumerate}
	    \item (Not done) Update this document to reflect any changes in procedure or dependencies. 
	    \item Upload the installers to SourceForge and update the release package.
		\end{enumerate}
 \end{enumerate}

\section{Bug Fixes}
\label{sec:BugFixes}

\begin{enumerate}
	\item (Not done) Move \texttt{spoutlock} and \texttt{spinlock} to dummy slots in CSOUND structure to preserve Csound API compatibility.
	\item (Not done) Change \texttt{SConstruct} to define \verb|FL_DLL| for linking with the FLTK DLL.
	\item (Not done) Change \texttt{SConstruct} to define \verb|_SCL_SECURE_NO_DEPRECATE| for compiling Gmm++.
	\item (Not done) Fix score editing bug in \texttt{csound5gui}.
	\item (Not done) Fix up installers for correct third party DLLs.
	\item (Not done) Fix up installers for correct Csound examples.
	\item (Not done) Make sure installers link to the frames version of the manual and include the quick reference.
	\item (Not done) Fix a bug with real-time notes not ending in CsoundVST, by restoring \texttt{relesing} flag. This needs to be tested for file rendering.
	\item (Not done) Fix up installers for correct third party DLLs.
	\item (Not done) Fix up installers for correct Csound examples.
\end{enumerate}

\section{Functional Tests}
\label{sec:FunctionalTests}

\begin{enumerate}
	\item (Not done) Ensure \texttt{csound /examples/trapped.csd} works.
	\item (Not done) Ensure \texttt{csound /examples/trapped.csd -otrapped.wav} works.
	\item (Not done) Ensure \texttt{csound5gui} renders \texttt{trapped.csd} to audio, and can be stopped and restarted.
	\item (Not done) Ensure \texttt{csound5gui} renders \texttt{trapped.csd} to soundfile, and can be stopped and restarted. 	
	\item (Not done) Ensure FLTK widgets work. 	
	\item (Not done) Ensure Python works with \texttt{python examples/koch.py}, which uses SoundFonts in FluidSynth opcodes, and \texttt{python examples/Lindenmayer.py}, which uses \texttt{CsoundAC}. 
	\item (Not done) Ensure Lua works with \verb|luajit examples/lua_example.lua|.
	\item (Not done) Ensure Lisp works with \verb|clisp interfaces/test.lisp|.
	\item (Not done) Ensure Java works with \verb|java -jar examples/java/CsoundEditor.jar|.
	\item (Not done) Ensure \texttt{CsoundVstShell} can load \texttt{examples/CsoundAC-midi.csd} and perform as a live MIDI instrument using a SoundFont in a FluidSynth instrument, a VST plugin instrument, and an STK instrument.
	\item (Not done) Ensure the Python opcodes work with some of the files in \url{Opcodes/py/examples}.
	\item (Not done) Ensure OSC works using example files.
	\item (Not done) Make sure installers link to the frames version of the manual and include the quick reference.
	\item (Not done) Ensure \texttt{CsoundVST} plugin works with \texttt{CsoundVST.csd} in VSTHost from \url{http://www.hermannseib.com/english/vsthost.htm}.
\end{enumerate}

\end{sloppypar}
\end{document}

