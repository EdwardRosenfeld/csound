\begin{comment}
\documentclass[10pt]{article}
\usepackage{fullpage, graphicx, url}
\setlength{\parskip}{1ex}
\setlength{\parindent}{0ex}
\title{midipitchbend}
\begin{document}


\begin{tabular}{ccc}
The Alternative Csound Reference Manual & & \\
Previous & &Next

\end{tabular}

%\hline 
\end{comment}
\section{midipitchbend}
midipitchbend --  Gets a MIDI pitchbend value. \subsection*{Description}


 \emph{midipitchbend}
 is designed to simplify writing instruments that can be used interchangeably for either score or MIDI input, and to make it easier to adapt instruments originally written for score input to work with MIDI input. 


  In general, it should be possible to write instrument definitions that work identically with both scores and MIDI, including both MIDI files and real-time MIDI input, without using any conditional statements, and that take full advantage of MIDI voice messages. 


  Note that correlating Csound instruments with MIDI channel numbers is done using the \emph{massign}
 opcode for real-time performance,. For file-driven performance, instrument numbers default to MIDI channel number + 1, but the defaults are overridden by any MIDI program change messages in the file. 
\subsection*{Syntax}


 \textbf{midipitchbend}
 xpitchbend [, ilow] [, ihigh]
\subsection*{Initialization}


 \emph{ilow}
 (optional) -- optional low value after rescaling, defaults to 0. 


 \emph{ihigh}
 (optional) -- optional high value after rescaling, defaults to 127. 
\subsection*{Performance}


 \emph{xpitchbend}
 -- returns the MIDI pitch bend during MIDI activation, remains unchanged otherwise. 


  If the instrument was activated by MIDI input, the opcode overwrites the value of \emph{xpitchbend}
 with the corresponding value from MIDI input. If the instrument was \emph{NOT}
 activated by MIDI input, the value of \emph{xpitchbend}
 remains unchanged. 


  This enables score p-fields to receive MIDI input data during MIDI activation, and score values otherwise. 


 


\begin{tabular}{cc}
\textbf{Adapting a score-activated Csound instrument.}
 \\
  &

  To adapt an ordinary Csound instrument designed for score activation for score/MIDI interoperability: 


 
\begin{itemize}
\item 

 Change all \emph{linen}
, \emph{linseg}
, and \emph{expseg}
 opcodes to \emph{linenr}
, \emph{linsegr}
, and \emph{expsegr}
, respectively, except for a de-clicking or damping envelope. This will not materially change score-driven performance.

\item 

 Add the following lines at the beginning of the instrument definition: 


 
\begin{lstlisting}
; Ensures that a MIDI-activated instrument
; will have a positive p3 field.
mididefault 60, p3 
; Puts MIDI key translated to cycles per
; second into p4, and MIDI velocity into p5
midinoteoncps p4, p5 
                
\end{lstlisting}


 


\end{itemize}


\end{tabular}

 Obviously, \emph{midinoteoncps}
 could be changed to \emph{midinoteonoct}
 or any of the other options, and the choice of p-fields is arbitrary. \subsection*{Examples}


  Here is an example of the midipitchbend opcode. It uses the files \emph{midipitchbend.orc}
 and \emph{midipitchbend.sco}
. 


 \textbf{Example 1. Example of the midipitchbend opcode.}

\begin{lstlisting}
/* midipitchbend.orc */
; Initialize the global variables.
sr = 44100
kr = 4410
ksmps = 10
nchnls = 1

; Instrument #1.
instr 1
  kpb init 0

  midipitchbend kpb

  ; Display the pitch-bend value when it changes.
  printk2 kpb
endin
/* midipitchbend.orc */
        
\end{lstlisting}
\begin{lstlisting}
/* midipitchbend.sco */
; Play Instrument #1 for ten seconds.
i 1 0 10
e
/* midipitchbend.sco */
        
\end{lstlisting}
 Its output should include lines like: \begin{lstlisting}
 i1     0.12695
 i1     0.00000
 i1    -0.01562
      
\end{lstlisting}
\subsection*{See Also}


 \emph{midichannelaftertouch}
, \emph{midicontrolchange}
, \emph{mididefault}
, \emph{midinoteoff}
, \emph{midinoteoncps}
, \emph{midinoteonkey}
, \emph{midinoteonoct}
, \emph{midinoteonpch}
, \emph{midipolyaftertouch}
, \emph{midiprogramchange}

\subsection*{Credits}


 Author: Michael Gogins


 Example written by Kevin Conder.


 New in version 4.20
%\hline 


\begin{comment}
\begin{tabular}{lcr}
Previous &Home &Next \\
midiout &Up &midipolyaftertouch

\end{tabular}


\end{document}
\end{comment}
